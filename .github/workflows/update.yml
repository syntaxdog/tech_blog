# .github/workflows/update.yml íŒŒì¼ ë‚´ìš©

name: Tistory Auto Sync and Commit

on:
  # 1. ìŠ¤ì¼€ì¤„ ì„¤ì •: UTC ê¸°ì¤€ìœ¼ë¡œ ë§¤ì¼ ìì •ì— ì‹¤í–‰ (í•œêµ­ ì‹œê°„ ê¸°ì¤€ ì˜¤ì „ 9ì‹œ)
  schedule:
    - cron: '0 0 * * *'
  # 2. ìˆ˜ë™ ì‹¤í–‰ ì˜µì…˜: GitHub ì›¹ì‚¬ì´íŠ¸ì—ì„œ 'Run workflow' ë²„íŠ¼ì„ ëˆŒëŸ¬ ì¦‰ì‹œ ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ í•¨
  workflow_dispatch:

jobs:
  sync:
    # ì´ ì‘ì—…ì€ ìµœì‹  Ubuntu í™˜ê²½ì—ì„œ ì‹¤í–‰ë©ë‹ˆë‹¤.
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ” ì €ì¥ì†Œ ì²´í¬ì•„ì›ƒ (ì½”ë“œ ê°€ì ¸ì˜¤ê¸°)
        # GitHub Actionsì—ì„œ ì €ì¥ì†Œ ì½”ë“œë¥¼ ëŸ¬ë„ˆë¡œ ê°€ì ¸ì˜¤ëŠ” í‘œì¤€ ì‘ì—…
        uses: actions/checkout@v4
        
      - name: ğŸ Python í™˜ê²½ ì„¤ì •
        # Python 3.x ë²„ì „ì„ ì„¤ì •í•©ë‹ˆë‹¤.
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      - name: ğŸ“¦ Python ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
        # requirements.txt íŒŒì¼ì— ëª…ì‹œëœ ëª¨ë“  ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.
        run: pip install -r requirements.txt

      - name: âš™ï¸ Git ì‚¬ìš©ì ì •ë³´ ì„¤ì •
        # ìŠ¤í¬ë¦½íŠ¸ê°€ ì»¤ë°‹ì„ ë§Œë“¤ ë•Œ ì‚¬ìš©í•  ì´ë¦„ê³¼ ì´ë©”ì¼ì„ ì„¤ì •í•©ë‹ˆë‹¤.
        run: |
          git config user.name github-actions
          git config user.email github-actions@users.noreply.github.com
          
      - name: ğŸš€ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ë° ì»¤ë°‹/í‘¸ì‹œ
        run: |
          python update_posts.py
          # posts í´ë”ë¥¼ í¬í•¨í•˜ì—¬ ëª¨ë“  ë³€ê²½ ì‚¬í•­ì„ ì¶”ì í•˜ë„ë¡ ëª…ì‹œì ìœ¼ë¡œ add í•©ë‹ˆë‹¤.
          git add .
          
          # ë³€ê²½ ì‚¬í•­ì´ ìˆì„ ë•Œë§Œ ì»¤ë°‹ë˜ë„ë¡ í•©ë‹ˆë‹¤. (echoë¡œ ì—ëŸ¬ ë¬´ì‹œ)
          git commit -m "Tistory post updated by action (Auto-sync)" || echo "No changes to commit"
          
          # 3. Git í‘¸ì‹œ (ê¶Œí•œ ë¬¸ì œ í•´ê²° í›„ ë‹¤ì‹œ ì‹œë„)
          # git push
